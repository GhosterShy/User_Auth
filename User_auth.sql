CREATE TABLE users (
    id NUMBER(10,0) GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
    created_at DATE NOT NULL,
    updated_at DATE NOT NULL,
    username VARCHAR2(255) NOT NULL UNIQUE,
    email VARCHAR2(255) NOT NULL UNIQUE,
    password_hash VARCHAR2(255) NOT NULL,
    phone VARCHAR2(255) NOT NULL UNIQUE,
    is_active NUMBER(1) NOT NULL,
    is_verified NUMBER(1) NOT NULL,
    last_login DATE,
    profile_picture VARCHAR2(255)
);

CREATE TABLE roles (
    id NUMBER(10,0) GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
    role_name VARCHAR2(255) NOT NULL UNIQUE
);

CREATE TABLE user_roles (
    id NUMBER(10,0) GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
    user_id NUMBER(10) NOT NULL,
    role_id NUMBER(10) NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (role_id) REFERENCES roles(id) ON DELETE CASCADE
);

CREATE TABLE sessions (
    id NUMBER(10,0) GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
    user_id NUMBER(10) NOT NULL,
    session_start DATE NOT NULL,
    session_end DATE,
    ip_address VARCHAR2(255) NOT NULL,
    device_info VARCHAR2(255) NOT NULL,
    location VARCHAR2(255),
    is_successful NUMBER(1) NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

CREATE TABLE login_history (
    id NUMBER(10,0) GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
    user_id NUMBER(10) NOT NULL,
    login_time DATE NOT NULL,
    logout_time DATE,
    ip_address VARCHAR2(255) NOT NULL,
    device_info VARCHAR2(255) NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

CREATE TABLE user_actions (
    id NUMBER(10,0) GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
    user_id NUMBER(10) NOT NULL,
    action_type VARCHAR2(255) NOT NULL,
    action_timestamp DATE NOT NULL,
    details VARCHAR2(4000),
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

CREATE TABLE user_history (
    id NUMBER(10,0) GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
    user_id NUMBER(10) NOT NULL,
    field_changed VARCHAR2(255) NOT NULL,
    old_value VARCHAR2(4000),
    new_value VARCHAR2(4000),
    changed_at DATE NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

CREATE TABLE security_logs (
    id NUMBER(10,0) GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
    user_id NUMBER(10),
    event_type VARCHAR2(255) NOT NULL,
    event_timestamp DATE NOT NULL,
    ip_address VARCHAR2(255) NOT NULL,
    device_info VARCHAR2(255) NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE SET NULL
);

CREATE TABLE api_logs (
    id NUMBER(10,0) GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
    user_id NUMBER(10),
    endpoint VARCHAR2(255) NOT NULL,
    request_method VARCHAR2(10) NOT NULL,
    request_timestamp DATE NOT NULL,
    response_status NUMBER(3) NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE SET NULL
);

CREATE TABLE subscriptions (
    id NUMBER(10,0) GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
    user_id NUMBER(10) NOT NULL,
    subscription_type VARCHAR2(255) NOT NULL,
    start_date DATE NOT NULL,
    end_date DATE NOT NULL,
    status VARCHAR2(50) NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

CREATE TABLE subscription_history (
    id NUMBER(10,0) GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
    subscription_id NUMBER(10) NOT NULL,
    change_type VARCHAR2(255) NOT NULL,
    change_date DATE NOT NULL,
    FOREIGN KEY (subscription_id) REFERENCES subscriptions(id) ON DELETE CASCADE
);

CREATE TABLE support_tickets (
    id NUMBER(10,0) GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
    user_id NUMBER(10) NOT NULL,
    subject VARCHAR2(255) NOT NULL,
    message VARCHAR2(4000) NOT NULL,
    status VARCHAR2(50) NOT NULL,
    created_at DATE NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

CREATE TABLE ticket_responses (
    id NUMBER(10,0) GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
    ticket_id NUMBER(10) NOT NULL,
    admin_id NUMBER(10),
    response_text VARCHAR2(4000) NOT NULL,
    response_date DATE NOT NULL,
    FOREIGN KEY (ticket_id) REFERENCES support_tickets(id) ON DELETE CASCADE,
    FOREIGN KEY (admin_id) REFERENCES users(id) ON DELETE SET NULL
);

CREATE TABLE user_settings (
    id NUMBER(10,0) GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
    user_id NUMBER(10) NOT NULL,
    setting_name VARCHAR2(255) NOT NULL,
    setting_value VARCHAR2(255) NOT NULL,
    updated_at DATE NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

CREATE TABLE notifications (
    id NUMBER(10,0) GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
    user_id NUMBER(10) NOT NULL,
    message VARCHAR2(255) NOT NULL,
    status VARCHAR2(50) NOT NULL,
    created_at DATE NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

CREATE TABLE audits (
    id NUMBER(10,0) GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
    user_id NUMBER(10),
    table_name VARCHAR2(255) NOT NULL,
    operation VARCHAR2(50) NOT NULL,
    timestamp DATE NOT NULL,
    details VARCHAR2(4000),
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE SET NULL
);

CREATE TABLE password_resets (
    id NUMBER(10,0) GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
    user_id NUMBER(10) NOT NULL,
    reset_token VARCHAR2(255) NOT NULL UNIQUE,
    expires_at DATE NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

CREATE TABLE email_verifications (
    id NUMBER(10,0) GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
    user_id NUMBER(10) NOT NULL,
    verification_token VARCHAR2(255) NOT NULL UNIQUE,
    expires_at DATE NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

CREATE TABLE messages (
    id NUMBER(10,0) GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
    sender_id NUMBER(10) NOT NULL,
    receiver_id NUMBER(10) NOT NULL,
    message_text VARCHAR2(4000) NOT NULL,
    sent_at DATE NOT NULL,
    FOREIGN KEY (sender_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (receiver_id) REFERENCES users(id) ON DELETE CASCADE
);

CREATE TABLE reports (
    id NUMBER(10,0) GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
    reported_user_id NUMBER(10) NOT NULL,
    reporter_user_id NUMBER(10) NOT NULL,
    reason VARCHAR2(255) NOT NULL,
    details VARCHAR2(4000),
    created_at DATE NOT NULL,
    FOREIGN KEY (reported_user_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (reporter_user_id) REFERENCES users(id) ON DELETE CASCADE
);

ALTER TABLE messages MODIFY id GENERATED BY DEFAULT AS IDENTITY (START WITH 1);
TRUNCATE TABLE users;
select *
from roles;

--users
INSERT INTO users (created_at, updated_at, username, email, password_hash, phone, is_active, is_verified, last_login, profile_picture) VALUES(TO_DATE('2024-03-01', 'YYYY-MM-DD'), TO_DATE('2024-03-01', 'YYYY-MM-DD'), 'user1', 'user1@example.com', 'hash1', '1234567801', 1, 1, TO_DATE('2024-03-01', 'YYYY-MM-DD'), 'pic1.jpg');
INSERT INTO users(created_at, updated_at, username, email, password_hash, phone, is_active, is_verified, last_login, profile_picture) VALUES (TO_DATE('2024-03-02', 'YYYY-MM-DD'), TO_DATE('2024-03-02', 'YYYY-MM-DD'), 'user2', 'user2@example.com', 'hash2', '1234567802', 1, 0, NULL, 'pic2.jpg');
INSERT INTO users(created_at, updated_at, username, email, password_hash, phone, is_active, is_verified, last_login, profile_picture) VALUES (TO_DATE('2024-03-03', 'YYYY-MM-DD'), TO_DATE('2024-03-03', 'YYYY-MM-DD'), 'user3', 'user3@example.com', 'hash3', '1234567803', 1, 1, TO_DATE('2024-03-03', 'YYYY-MM-DD'), 'pic3.jpg');
INSERT INTO users(created_at, updated_at, username, email, password_hash, phone, is_active, is_verified, last_login, profile_picture) VALUES (TO_DATE('2024-03-04', 'YYYY-MM-DD'), TO_DATE('2024-03-04', 'YYYY-MM-DD'), 'user4', 'user4@example.com', 'hash4', '1234567804', 1, 1, TO_DATE('2024-03-04', 'YYYY-MM-DD'), 'pic4.jpg');
INSERT INTO users(created_at, updated_at, username, email, password_hash, phone, is_active, is_verified, last_login, profile_picture) VALUES (TO_DATE('2024-03-05', 'YYYY-MM-DD'), TO_DATE('2024-03-05', 'YYYY-MM-DD'), 'user5', 'user5@example.com', 'hash5', '1234567805', 1, 0, NULL, 'pic5.jpg');
INSERT INTO users(created_at, updated_at, username, email, password_hash, phone, is_active, is_verified, last_login, profile_picture) VALUES (TO_DATE('2024-03-06', 'YYYY-MM-DD'), TO_DATE('2024-03-06', 'YYYY-MM-DD'), 'user6', 'user6@example.com', 'hash6', '1234567806', 1, 1, TO_DATE('2024-03-06', 'YYYY-MM-DD'), 'pic6.jpg');
INSERT INTO users(created_at, updated_at, username, email, password_hash, phone, is_active, is_verified, last_login, profile_picture) VALUES (TO_DATE('2024-03-07', 'YYYY-MM-DD'), TO_DATE('2024-03-07', 'YYYY-MM-DD'), 'user7', 'user7@example.com', 'hash7', '1234567807', 1, 1, TO_DATE('2024-03-07', 'YYYY-MM-DD'), 'pic7.jpg');
INSERT INTO users(created_at, updated_at, username, email, password_hash, phone, is_active, is_verified, last_login, profile_picture) VALUES (TO_DATE('2024-03-08', 'YYYY-MM-DD'), TO_DATE('2024-03-08', 'YYYY-MM-DD'), 'user8', 'user8@example.com', 'hash8', '1234567808', 1, 0, NULL, 'pic8.jpg');
INSERT INTO users(created_at, updated_at, username, email, password_hash, phone, is_active, is_verified, last_login, profile_picture) VALUES (TO_DATE('2024-03-09', 'YYYY-MM-DD'), TO_DATE('2024-03-09', 'YYYY-MM-DD'), 'user9', 'user9@example.com', 'hash9', '1234567809', 1, 1, TO_DATE('2024-03-09', 'YYYY-MM-DD'), 'pic9.jpg');
INSERT INTO users(created_at, updated_at, username, email, password_hash, phone, is_active, is_verified, last_login, profile_picture) VALUES (TO_DATE('2024-03-10', 'YYYY-MM-DD'), TO_DATE('2024-03-10', 'YYYY-MM-DD'), 'user10', 'user10@example.com', 'hash10', '1234567810', 1, 1, TO_DATE('2024-03-10', 'YYYY-MM-DD'), 'pic10.jpg');
INSERT INTO users (created_at, updated_at, username, email, password_hash, phone, is_active, is_verified, last_login, profile_picture)VALUES (TO_DATE('2024-03-11', 'YYYY-MM-DD'), TO_DATE('2024-03-11', 'YYYY-MM-DD'), 'user11', 'user11@example.com', 'hash11', '1234567811', 1, 0, NULL, 'pic11.jpg');



INSERT INTO roles (role_name) VALUES ('Admin');
INSERT INTO roles (role_name) VALUES ('User');
INSERT INTO roles (role_name) VALUES ('Manager');
INSERT INTO roles (role_name) VALUES ('Moderator');
INSERT INTO roles (role_name) VALUES ('Support');
INSERT INTO roles (role_name) VALUES ('Developer');
INSERT INTO roles (role_name) VALUES ('Analyst');
INSERT INTO roles (role_name) VALUES ('HR');
INSERT INTO roles (role_name) VALUES ('Finance');
INSERT INTO roles (role_name) VALUES ('Marketing');

select *
from users;


INSERT INTO user_roles (user_id, role_id) VALUES (1, 1);
INSERT INTO user_roles (user_id, role_id) VALUES (2, 2);
INSERT INTO user_roles (user_id, role_id) VALUES (3, 3);
INSERT INTO user_roles (user_id, role_id) VALUES (4, 4);
INSERT INTO user_roles (user_id, role_id) VALUES (5, 5);
INSERT INTO user_roles (user_id, role_id) VALUES (6, 6);
INSERT INTO user_roles (user_id, role_id) VALUES (7, 7);
INSERT INTO user_roles (user_id, role_id) VALUES (8, 8);
INSERT INTO user_roles (user_id, role_id) VALUES (9, 9);
INSERT INTO user_roles (user_id, role_id) VALUES (10, 10);



INSERT INTO sessions (user_id, session_start, session_end, ip_address, device_info, location, is_successful)
VALUES (1, TO_DATE('2024-03-01 10:00', 'YYYY-MM-DD HH24:MI'), TO_DATE('2024-03-01 12:00', 'YYYY-MM-DD HH24:MI'), '192.168.1.1', 'Chrome', 'USA', 1);

INSERT INTO sessions(user_id, session_start, session_end, ip_address, device_info, location, is_successful)  VALUES (2, TO_DATE('2024-03-02 11:00', 'YYYY-MM-DD HH24:MI'), NULL, '192.168.1.2', 'Firefox', 'Canada', 1);
INSERT INTO sessions(user_id, session_start, session_end, ip_address, device_info, location, is_successful)  VALUES (3, TO_DATE('2024-03-03 14:00', 'YYYY-MM-DD HH24:MI'), TO_DATE('2024-03-03 15:30', 'YYYY-MM-DD HH24:MI'), '192.168.1.3', 'Edge', 'Mexico', 1);
INSERT INTO sessions(user_id, session_start, session_end, ip_address, device_info, location, is_successful)  VALUES (4, TO_DATE('2024-03-04 09:00', 'YYYY-MM-DD HH24:MI'), NULL, '192.168.1.4', 'Safari', 'UK', 1);
INSERT INTO sessions(user_id, session_start, session_end, ip_address, device_info, location, is_successful)  VALUES (5, TO_DATE('2024-03-05 20:00', 'YYYY-MM-DD HH24:MI'), TO_DATE('2024-03-05 22:00', 'YYYY-MM-DD HH24:MI'), '192.168.1.5', 'Opera', 'Germany', 1);
INSERT INTO sessions(user_id, session_start, session_end, ip_address, device_info, location, is_successful)  VALUES (6, TO_DATE('2024-03-06 18:30', 'YYYY-MM-DD HH24:MI'), NULL, '192.168.1.6', 'Chrome', 'France', 1);
INSERT INTO sessions(user_id, session_start, session_end, ip_address, device_info, location, is_successful)  VALUES (7, TO_DATE('2024-03-07 12:00', 'YYYY-MM-DD HH24:MI'), TO_DATE('2024-03-07 14:30', 'YYYY-MM-DD HH24:MI'), '192.168.1.7', 'Firefox', 'Italy', 1);
INSERT INTO sessions(user_id, session_start, session_end, ip_address, device_info, location, is_successful)  VALUES (8, TO_DATE('2024-03-08 16:00', 'YYYY-MM-DD HH24:MI'), NULL, '192.168.1.8', 'Edge', 'Spain', 1);
INSERT INTO sessions(user_id, session_start, session_end, ip_address, device_info, location, is_successful)  VALUES (9, TO_DATE('2024-03-09 21:00', 'YYYY-MM-DD HH24:MI'), TO_DATE('2024-03-09 23:30', 'YYYY-MM-DD HH24:MI'), '192.168.1.9', 'Safari', 'Japan', 1);
INSERT INTO sessions(user_id, session_start, session_end, ip_address, device_info, location, is_successful)  VALUES (10, TO_DATE('2024-03-10 08:00', 'YYYY-MM-DD HH24:MI'), NULL, '192.168.1.10', 'Opera', 'India', 1);



INSERT INTO subscriptions (user_id, subscription_type, start_date, end_date, status)
VALUES (1, 'Premium', TO_DATE('2024-02-01', 'YYYY-MM-DD'), TO_DATE('2025-02-01', 'YYYY-MM-DD'), 'Active');

INSERT INTO subscriptions(user_id, subscription_type, start_date, end_date, status)  VALUES (2, 'Standard', TO_DATE('2024-01-15', 'YYYY-MM-DD'), TO_DATE('2025-01-15', 'YYYY-MM-DD'), 'Active');
INSERT INTO subscriptions(user_id, subscription_type, start_date, end_date, status)  VALUES (3, 'Basic', TO_DATE('2023-12-10', 'YYYY-MM-DD'), TO_DATE('2024-12-10', 'YYYY-MM-DD'), 'Expired');
INSERT INTO subscriptions(user_id, subscription_type, start_date, end_date, status)  VALUES (4, 'Pro', TO_DATE('2023-11-05', 'YYYY-MM-DD'), TO_DATE('2024-11-05', 'YYYY-MM-DD'), 'Active');
INSERT INTO subscriptions(user_id, subscription_type, start_date, end_date, status)  VALUES (5, 'Enterprise', TO_DATE('2023-10-20', 'YYYY-MM-DD'), TO_DATE('2024-10-20', 'YYYY-MM-DD'), 'Cancelled');
INSERT INTO subscriptions(user_id, subscription_type, start_date, end_date, status)  VALUES (6, 'Premium', TO_DATE('2023-09-15', 'YYYY-MM-DD'), TO_DATE('2024-09-15', 'YYYY-MM-DD'), 'Active');
INSERT INTO subscriptions(user_id, subscription_type, start_date, end_date, status)  VALUES (7, 'Standard', TO_DATE('2023-08-10', 'YYYY-MM-DD'), TO_DATE('2024-08-10', 'YYYY-MM-DD'), 'Expired');
INSERT INTO subscriptions(user_id, subscription_type, start_date, end_date, status)  VALUES (8, 'Basic', TO_DATE('2023-07-05', 'YYYY-MM-DD'), TO_DATE('2024-07-05', 'YYYY-MM-DD'), 'Active');
INSERT INTO subscriptions(user_id, subscription_type, start_date, end_date, status)  VALUES (9, 'Pro', TO_DATE('2023-06-01', 'YYYY-MM-DD'), TO_DATE('2024-06-01', 'YYYY-MM-DD'), 'Cancelled');
INSERT INTO subscriptions(user_id, subscription_type, start_date, end_date, status)  VALUES (10, 'Enterprise', TO_DATE('2023-05-15', 'YYYY-MM-DD'), TO_DATE('2024-05-15', 'YYYY-MM-DD'), 'Active');



INSERT INTO login_history (user_id, login_time, logout_time, ip_address, device_info)
VALUES (1, TO_DATE('2024-03-01 08:30', 'YYYY-MM-DD HH24:MI'), TO_DATE('2024-03-01 10:00', 'YYYY-MM-DD HH24:MI'), '192.168.1.1', 'Chrome');

INSERT INTO login_history(user_id, login_time, logout_time, ip_address, device_info) VALUES (2, TO_DATE('2024-03-02 09:00', 'YYYY-MM-DD HH24:MI'), NULL, '192.168.1.2', 'Firefox');
INSERT INTO login_history(user_id, login_time, logout_time, ip_address, device_info) VALUES (3, TO_DATE('2024-03-03 12:00', 'YYYY-MM-DD HH24:MI'), TO_DATE('2024-03-03 12:45', 'YYYY-MM-DD HH24:MI'), '192.168.1.3', 'Safari');
INSERT INTO login_history(user_id, login_time, logout_time, ip_address, device_info) VALUES (4, TO_DATE('2024-03-04 14:15', 'YYYY-MM-DD HH24:MI'), NULL, '192.168.1.4', 'Edge');
INSERT INTO login_history(user_id, login_time, logout_time, ip_address, device_info) VALUES (5, TO_DATE('2024-03-05 07:30', 'YYYY-MM-DD HH24:MI'), TO_DATE('2024-03-05 08:50', 'YYYY-MM-DD HH24:MI'), '192.168.1.5', 'Opera');
INSERT INTO login_history(user_id, login_time, logout_time, ip_address, device_info) VALUES (6, TO_DATE('2024-03-06 16:40', 'YYYY-MM-DD HH24:MI'), NULL, '192.168.1.6', 'Chrome');
INSERT INTO login_history(user_id, login_time, logout_time, ip_address, device_info) VALUES (7, TO_DATE('2024-03-07 20:00', 'YYYY-MM-DD HH24:MI'), TO_DATE('2024-03-07 21:15', 'YYYY-MM-DD HH24:MI'), '192.168.1.7', 'Firefox');
INSERT INTO login_history(user_id, login_time, logout_time, ip_address, device_info) VALUES (8, TO_DATE('2024-03-08 10:20', 'YYYY-MM-DD HH24:MI'), NULL, '192.168.1.8', 'Safari');
INSERT INTO login_history(user_id, login_time, logout_time, ip_address, device_info) VALUES (9, TO_DATE('2024-03-09 11:00', 'YYYY-MM-DD HH24:MI'), TO_DATE('2024-03-09 12:30', 'YYYY-MM-DD HH24:MI'), '192.168.1.9', 'Edge');
INSERT INTO login_history(user_id, login_time, logout_time, ip_address, device_info) VALUES (10, TO_DATE('2024-03-10 22:15', 'YYYY-MM-DD HH24:MI'), NULL, '192.168.1.10', 'Opera');


INSERT INTO user_actions (user_id, action_type, action_timestamp, details)
VALUES (1, 'Login', TO_DATE('2024-03-01 08:30', 'YYYY-MM-DD HH24:MI'), 'User logged in successfully');

INSERT INTO user_actions(user_id, action_type, action_timestamp, details) VALUES (2, 'Logout', TO_DATE('2024-03-02 09:15', 'YYYY-MM-DD HH24:MI'), 'User logged out');
INSERT INTO user_actions(user_id, action_type, action_timestamp, details) VALUES (3, 'Update Profile', TO_DATE('2024-03-03 14:20', 'YYYY-MM-DD HH24:MI'), 'Updated email address');
INSERT INTO user_actions(user_id, action_type, action_timestamp, details) VALUES (4, 'Password Change', TO_DATE('2024-03-04 17:00', 'YYYY-MM-DD HH24:MI'), 'User changed password');
INSERT INTO user_actions(user_id, action_type, action_timestamp, details) VALUES (5, 'Subscription Renewed', TO_DATE('2024-03-05 11:45', 'YYYY-MM-DD HH24:MI'), 'User renewed premium subscription');
INSERT INTO user_actions(user_id, action_type, action_timestamp, details) VALUES (6, 'Login', TO_DATE('2024-03-06 19:20', 'YYYY-MM-DD HH24:MI'), 'User logged in');
INSERT INTO user_actions(user_id, action_type, action_timestamp, details) VALUES (7, 'Logout', TO_DATE('2024-03-07 22:10', 'YYYY-MM-DD HH24:MI'), 'User logged out');
INSERT INTO user_actions(user_id, action_type, action_timestamp, details) VALUES (8, 'Payment Processed', TO_DATE('2024-03-08 15:30', 'YYYY-MM-DD HH24:MI'), 'User made a payment of $9.99');
INSERT INTO user_actions(user_id, action_type, action_timestamp, details) VALUES (9, 'New Subscription', TO_DATE('2024-03-09 10:00', 'YYYY-MM-DD HH24:MI'), 'User subscribed to a new plan');
INSERT INTO user_actions(user_id, action_type, action_timestamp, details) VALUES (10, 'Profile Picture Updated', TO_DATE('2024-03-10 18:40', 'YYYY-MM-DD HH24:MI'), 'User uploaded a new profile picture');




INSERT INTO notifications (user_id, message, status, created_at)
VALUES (1, 'Welcome to our platform!', 'Unread', TO_DATE('2024-03-01', 'YYYY-MM-DD'));

INSERT INTO notifications(user_id, message, status, created_at) VALUES (2, 'Your subscription is about to expire', 'Unread', TO_DATE('2024-03-02', 'YYYY-MM-DD'));
INSERT INTO notifications(user_id, message, status, created_at) VALUES (3, 'Password changed successfully', 'Read', TO_DATE('2024-03-03', 'YYYY-MM-DD'));
INSERT INTO notifications(user_id, message, status, created_at) VALUES (4, 'New login detected from a different device', 'Unread', TO_DATE('2024-03-04', 'YYYY-MM-DD'));
INSERT INTO notifications(user_id, message, status, created_at) VALUES (5, 'Payment received', 'Read', TO_DATE('2024-03-05', 'YYYY-MM-DD'));
INSERT INTO notifications(user_id, message, status, created_at) VALUES (6, 'New feature available!', 'Unread', TO_DATE('2024-03-06', 'YYYY-MM-DD'));
INSERT INTO notifications(user_id, message, status, created_at) VALUES (7, 'Your support ticket has been updated', 'Unread', TO_DATE('2024-03-07', 'YYYY-MM-DD'));
INSERT INTO notifications(user_id, message, status, created_at) VALUES (8, 'Security alert: Unusual activity detected', 'Unread', TO_DATE('2024-03-08', 'YYYY-MM-DD'));
INSERT INTO notifications(user_id, message, status, created_at) VALUES (9, 'Your account has been verified', 'Read', TO_DATE('2024-03-09', 'YYYY-MM-DD'));
INSERT INTO notifications(user_id, message, status, created_at) VALUES (10, 'Your subscription has been renewed successfully', 'Read', TO_DATE('2024-03-10', 'YYYY-MM-DD'));


--security_logs
INSERT INTO security_logs (user_id, event_type, event_timestamp, ip_address, device_info) VALUES
(1, 'Failed Login Attempt', TO_DATE('2024-03-01 08:30', 'YYYY-MM-DD HH24:MI'), '192.168.1.1', 'Chrome');
INSERT INTO security_logs (user_id, event_type, event_timestamp, ip_address, device_info) VALUES (2, 'Password Changed', TO_DATE('2024-03-02 10:00', 'YYYY-MM-DD HH24:MI'), '192.168.1.2', 'Firefox');
INSERT INTO security_logs (user_id, event_type, event_timestamp, ip_address, device_info) VALUES (3, 'Successful Login', TO_DATE('2024-03-03 12:15', 'YYYY-MM-DD HH24:MI'), '192.168.1.3', 'Safari');
INSERT INTO security_logs (user_id, event_type, event_timestamp, ip_address, device_info) VALUES (4, 'Account Locked', TO_DATE('2024-03-04 14:20', 'YYYY-MM-DD HH24:MI'), '192.168.1.4', 'Edge');
INSERT INTO security_logs (user_id, event_type, event_timestamp, ip_address, device_info) VALUES (5, 'Session Expired', TO_DATE('2024-03-05 15:45', 'YYYY-MM-DD HH24:MI'), '192.168.1.5', 'Opera');
INSERT INTO security_logs (user_id, event_type, event_timestamp, ip_address, device_info) VALUES (6, 'Successful Login', TO_DATE('2024-03-06 17:30', 'YYYY-MM-DD HH24:MI'), '192.168.1.6', 'Chrome');
INSERT INTO security_logs (user_id, event_type, event_timestamp, ip_address, device_info) VALUES (7, 'Unusual Activity Detected', TO_DATE('2024-03-07 19:00', 'YYYY-MM-DD HH24:MI'), '192.168.1.7', 'Firefox');
INSERT INTO security_logs (user_id, event_type, event_timestamp, ip_address, device_info) VALUES (8, 'Multi-Factor Authentication Enabled', TO_DATE('2024-03-08 21:15', 'YYYY-MM-DD HH24:MI'), '192.168.1.8', 'Safari');
INSERT INTO security_logs (user_id, event_type, event_timestamp, ip_address, device_info) VALUES (9, 'Security Question Updated', TO_DATE('2024-03-09 22:40', 'YYYY-MM-DD HH24:MI'), '192.168.1.9', 'Edge');
INSERT INTO security_logs (user_id, event_type, event_timestamp, ip_address, device_info) VALUES (10, 'Session Terminated', TO_DATE('2024-03-10 23:10', 'YYYY-MM-DD HH24:MI'), '192.168.1.10', 'Opera');



INSERT INTO api_logs (user_id, endpoint, request_method, request_timestamp, response_status) VALUES
(1, '/api/login', 'POST', TO_DATE('2024-03-01 08:30', 'YYYY-MM-DD HH24:MI'), 200);
INSERT INTO api_logs (user_id, endpoint, request_method, request_timestamp, response_status) VALUES (2, '/api/logout', 'POST', TO_DATE('2024-03-02 10:00', 'YYYY-MM-DD HH24:MI'), 200);
INSERT INTO api_logs (user_id, endpoint, request_method, request_timestamp, response_status) VALUES (3, '/api/profile', 'GET', TO_DATE('2024-03-03 12:15', 'YYYY-MM-DD HH24:MI'), 200);
INSERT INTO api_logs (user_id, endpoint, request_method, request_timestamp, response_status) VALUES (4, '/api/update_password', 'PUT', TO_DATE('2024-03-04 14:20', 'YYYY-MM-DD HH24:MI'), 400);
INSERT INTO api_logs (user_id, endpoint, request_method, request_timestamp, response_status) VALUES (5, '/api/delete_account', 'DELETE', TO_DATE('2024-03-05 15:45', 'YYYY-MM-DD HH24:MI'), 403);
INSERT INTO api_logs (user_id, endpoint, request_method, request_timestamp, response_status) VALUES (6, '/api/renew_subscription', 'POST', TO_DATE('2024-03-06 17:30', 'YYYY-MM-DD HH24:MI'), 200);
INSERT INTO api_logs (user_id, endpoint, request_method, request_timestamp, response_status) VALUES (7, '/api/support_ticket', 'POST', TO_DATE('2024-03-07 19:00', 'YYYY-MM-DD HH24:MI'), 201);
INSERT INTO api_logs (user_id, endpoint, request_method, request_timestamp, response_status) VALUES (8, '/api/login', 'POST', TO_DATE('2024-03-08 21:15', 'YYYY-MM-DD HH24:MI'), 500);
INSERT INTO api_logs (user_id, endpoint, request_method, request_timestamp, response_status) VALUES (9, '/api/payment', 'POST', TO_DATE('2024-03-09 22:40', 'YYYY-MM-DD HH24:MI'), 200);
INSERT INTO api_logs (user_id, endpoint, request_method, request_timestamp, response_status) VALUES (10, '/api/update_settings', 'PUT', TO_DATE('2024-03-10 23:10', 'YYYY-MM-DD HH24:MI'), 200);


INSERT INTO reports (reported_user_id, reporter_user_id, reason, details, created_at) VALUES(2, 1, 'Spam', 'User posted irrelevant content in the forum', TO_DATE('2024-03-01', 'YYYY-MM-DD'));
INSERT INTO reports (reported_user_id, reporter_user_id, reason, details, created_at) VALUES (3, 2, 'Harassment', 'Offensive messages sent in private chat', TO_DATE('2024-03-02', 'YYYY-MM-DD'));
INSERT INTO reports (reported_user_id, reporter_user_id, reason, details, created_at) VALUES (4, 3, 'Fake Profile', 'User is impersonating someone else', TO_DATE('2024-03-03', 'YYYY-MM-DD'));
INSERT INTO reports (reported_user_id, reporter_user_id, reason, details, created_at) VALUES (5, 4, 'Scam', 'Attempt to defraud users via fake offers', TO_DATE('2024-03-04', 'YYYY-MM-DD'));
INSERT INTO reports (reported_user_id, reporter_user_id, reason, details, created_at) VALUES (6, 5, 'Hate Speech', 'Racist comments made in a public post', TO_DATE('2024-03-05', 'YYYY-MM-DD'));
INSERT INTO reports (reported_user_id, reporter_user_id, reason, details, created_at) VALUES (7, 6, 'Spam', 'User repeatedly posts promotional links', TO_DATE('2024-03-06', 'YYYY-MM-DD'));
INSERT INTO reports (reported_user_id, reporter_user_id, reason, details, created_at) VALUES (8, 7, 'Harassment', 'Threats made via direct messages', TO_DATE('2024-03-07', 'YYYY-MM-DD'));
INSERT INTO reports (reported_user_id, reporter_user_id, reason, details, created_at) VALUES (9, 8, 'Fake Profile', 'Profile appears to be fake with misleading info', TO_DATE('2024-03-08', 'YYYY-MM-DD'));
INSERT INTO reports (reported_user_id, reporter_user_id, reason, details, created_at) VALUES (10, 9, 'Scam', 'User is running a fraudulent giveaway', TO_DATE('2024-03-09', 'YYYY-MM-DD'));
INSERT INTO reports (reported_user_id, reporter_user_id, reason, details, created_at) VALUES (1, 10, 'Hate Speech', 'User posted offensive remarks in a discussion', TO_DATE('2024-03-10', 'YYYY-MM-DD'));


INSERT INTO messages (sender_id, receiver_id, message_text, sent_at) VALUES(1, 2, 'Hey! How are you?', TO_DATE('2024-03-01 09:00', 'YYYY-MM-DD HH24:MI'));
INSERT INTO messages (sender_id, receiver_id, message_text, sent_at) VALUES (2, 3, 'Check out this new feature!', TO_DATE('2024-03-02 10:15', 'YYYY-MM-DD HH24:MI'));
INSERT INTO messages (sender_id, receiver_id, message_text, sent_at) VALUES (3, 4, 'Let’s meet up later.', TO_DATE('2024-03-03 12:45', 'YYYY-MM-DD HH24:MI'));
INSERT INTO messages (sender_id, receiver_id, message_text, sent_at) VALUES (4, 5, 'Can you help me with my issue?', TO_DATE('2024-03-04 14:30', 'YYYY-MM-DD HH24:MI'));
INSERT INTO messages (sender_id, receiver_id, message_text, sent_at) VALUES (5, 6, 'Great job on the project!', TO_DATE('2024-03-05 16:00', 'YYYY-MM-DD HH24:MI'));
INSERT INTO messages (sender_id, receiver_id, message_text, sent_at) VALUES (6, 7, 'Reminder: Meeting tomorrow at 10 AM.', TO_DATE('2024-03-06 17:50', 'YYYY-MM-DD HH24:MI'));
INSERT INTO messages (sender_id, receiver_id, message_text, sent_at) VALUES (7, 8, 'Here is the file you requested.', TO_DATE('2024-03-07 19:20', 'YYYY-MM-DD HH24:MI'));
INSERT INTO messages (sender_id, receiver_id, message_text, sent_at) VALUES (8, 9, 'Your order has been shipped!', TO_DATE('2024-03-08 21:10', 'YYYY-MM-DD HH24:MI'));
INSERT INTO messages (sender_id, receiver_id, message_text, sent_at) VALUES (9, 10, 'Let’s discuss this over a call.', TO_DATE('2024-03-09 22:55', 'YYYY-MM-DD HH24:MI'));
INSERT INTO messages (sender_id, receiver_id, message_text, sent_at) VALUES (10, 1, 'Happy birthday! Hope you have a great day.', TO_DATE('2024-03-10 23:30', 'YYYY-MM-DD HH24:MI'));



ALTER SESSION SET "_ORACLE_SCRIPT"=true;

CREATE ROLE admin_role;
CREATE ROLE user_role;
CREATE ROLE read_only_role;


CREATE USER full_admin IDENTIFIED BY pass1234;
CREATE USER normal_user IDENTIFIED BY pass1234;


GRANT CONNECT, RESOURCE, DBA TO admin_user;
GRANT admin_role TO admin_user;


GRANT CONNECT TO normal_user;
GRANT user_role TO normal_user;


GRANT SELECT ON users TO read_only_role;
GRANT SELECT ON roles TO read_only_role;
GRANT SELECT ON user_roles TO read_only_role;
GRANT read_only_role TO normal_user;



--index
CREATE INDEX idx_sessions_user_id ON sessions(user_id);

--OIN сұранысы (пайдаланушының соңғы сессиясын алу)
SELECT u.username, s.session_start, s.ip_address
FROM users u
JOIN sessions s ON u.id = s.user_id
WHERE u.username = 'user2'
ORDER BY s.session_start DESC;

--GROUP BY және HAVING сұранысы
SELECT user_id, COUNT(*) AS login_count
FROM login_history
GROUP BY user_id
HAVING COUNT(*) > 5;

--Агрегаттық функциялар
SELECT COUNT(*) AS total_users, AVG(session_end - session_start) AS avg_session_time
FROM sessions;


